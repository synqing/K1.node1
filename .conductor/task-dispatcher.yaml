# K1.node1 Phase 5.3 Task Dispatcher Configuration
# Defines all 22 atomic tasks with dependencies, agent specs, and validation
# Version: 1.0
# Date: 2025-11-10
# Auto-generated from: docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md

---
dispatcher:
  version: 1.0
  phase: "Phase 5.3 - Error Recovery & Advanced Features"
  totalTasks: 22
  estimatedDuration: "5 days"
  parallelGroups: 5
  maxConcurrentAgents: 8
  checkpointInterval: "8 hours"
  logDir: "docs/09-reports/"

---
# GROUP A: Foundation (Day 1 - No Dependencies)
# Can execute immediately in parallel
taskGroups:
  - groupId: "GROUP_A"
    name: "Foundation Layer"
    parallelism: 4
    day: 1
    tasks:
      - taskId: "T1"
        title: "PostgreSQL Schema Design"
        priority: "CRITICAL"
        effortHours: 4
        agent:
          type: "database-engineer"
          specialization: "PostgreSQL, migrations, schema design"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T1: PostgreSQL Schema Design"
          - path: "docs/04-planning/phase5.3_database_schema.sql"
        outputs:
          - path: "database/migrations/001_error_recovery_and_scheduling.sql"
            type: "sql-migration"
          - path: "database/seeds/test_data.sql"
            type: "sql-seed"
          - path: "database/docs/schema.md"
            type: "documentation"
        validation:
          - type: "file_exists"
            paths: ["database/migrations/001_*.sql", "database/seeds/test_data.sql"]
          - type: "sql_syntax"
            files: ["database/migrations/001_*.sql"]
          - type: "schema_validation"
            tables: ["retry_attempts", "circuit_breaker_states", "dead_letter_queue", "schedules", "execution_history"]
            indexes: ["retry_attempts_task_id", "circuit_breaker_states_service_name", "schedules_next_execution_at"]
        dependencies: []
        relatedDocs:
          - "docs/04-planning/phase5.3_database_schema.sql"
          - "docs/02-adr/ADR-0013-conductor-deployment-resilience.md"

      - taskId: "T2"
        title: "Error Recovery Service Interface"
        priority: "CRITICAL"
        effortHours: 3
        agent:
          type: "backend-engineer"
          specialization: "TypeScript, API design, type safety"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T2: Error Recovery Service Interface"
          - path: "docs/04-planning/phase5.3_service_interfaces.ts"
        outputs:
          - path: "conductor-api/src/types/error-recovery.types.ts"
            type: "typescript"
          - path: "conductor-api/src/types/retry-policy.types.ts"
            type: "typescript"
          - path: "conductor-api/src/types/circuit-breaker.types.ts"
            type: "typescript"
          - path: "conductor-api/src/schemas/error-recovery.schemas.ts"
            type: "typescript"
          - path: "conductor-api/src/interfaces/error-recovery.interface.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/types/*.ts", "conductor-api/src/schemas/*.ts"]
          - type: "typescript_compile"
            files: ["conductor-api/src/types/", "conductor-api/src/schemas/"]
          - type: "zod_schema_validation"
            schemas: ["RetryPolicy", "CircuitBreakerConfig", "CircuitBreakerState"]
        dependencies: []
        relatedDocs:
          - "docs/04-planning/phase5.3_service_interfaces.ts"

      - taskId: "T3"
        title: "API v2 Router Scaffolding"
        priority: "CRITICAL"
        effortHours: 3
        agent:
          type: "backend-engineer"
          specialization: "Express/Fastify, API routing, middleware"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T3: API v2 Router Scaffolding"
          - path: "docs/04-planning/phase_5_3_implementation_decision_matrix.md"
        outputs:
          - path: "conductor-api/src/routes/v2/index.ts"
            type: "typescript"
          - path: "conductor-api/src/routes/v2/error-recovery.ts"
            type: "typescript"
          - path: "conductor-api/src/routes/v2/scheduling.ts"
            type: "typescript"
          - path: "conductor-api/src/middleware/v2-authentication.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/routes/v2/", "conductor-api/src/middleware/"]
          - type: "typescript_compile"
            files: ["conductor-api/src/routes/v2/"]
          - type: "route_definitions"
            minRoutes: 6
        dependencies: []
        relatedDocs:
          - "docs/04-planning/phase_5_3_implementation_decision_matrix.md"
          - "docs/design/K1NDesign_PHASE5_3_4_API_V2_ARCHITECTURE_v1.0_20251109.md"

      - taskId: "T16"
        title: "React Dashboard Scaffolding"
        priority: "HIGH"
        effortHours: 4
        agent:
          type: "frontend-engineer"
          specialization: "React, TypeScript, component structure"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T16: React Dashboard Scaffolding"
          - path: "docs/design/K1NDesign_PHASE5_3_3_DASHBOARD_ARCHITECTURE_v1.0_20251109.md"
        outputs:
          - path: "webapp/src/pages/Dashboard.tsx"
            type: "typescript-react"
          - path: "webapp/src/components/DashboardLayout.tsx"
            type: "typescript-react"
          - path: "webapp/src/hooks/useDashboardState.ts"
            type: "typescript"
          - path: "webapp/src/types/dashboard.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["webapp/src/pages/Dashboard.tsx", "webapp/src/components/DashboardLayout.tsx"]
          - type: "typescript_compile"
            files: ["webapp/src/pages/", "webapp/src/components/"]
          - type: "react_component_structure"
            components: ["Dashboard", "DashboardLayout"]
        dependencies: []
        relatedDocs:
          - "docs/design/K1NDesign_PHASE5_3_3_DASHBOARD_ARCHITECTURE_v1.0_20251109.md"

  - groupId: "GROUP_B"
    name: "Core Services Layer"
    parallelism: 5
    day: 2
    dependsOnGroup: "GROUP_A"
    tasks:
      - taskId: "T4"
        title: "Retry Engine Implementation"
        priority: "CRITICAL"
        effortHours: 4
        agent:
          type: "backend-engineer"
          specialization: "Retry logic, exponential backoff, state management"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T4: Retry Engine Implementation"
        outputs:
          - path: "conductor-api/src/services/retry-engine.ts"
            type: "typescript"
          - path: "conductor-api/src/workers/retry-scheduler.ts"
            type: "typescript"
          - path: "conductor-api/src/tests/retry-engine.test.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/services/retry-engine.ts"]
          - type: "typescript_compile"
            files: ["conductor-api/src/services/retry-engine.ts"]
          - type: "unit_tests"
            testFile: "conductor-api/src/tests/retry-engine.test.ts"
            minTests: 8
        dependencies: ["T1", "T2"]
        relatedDocs:
          - "docs/04-planning/phase5.3_implementation_architecture.md"

      - taskId: "T5"
        title: "Circuit Breaker Service"
        priority: "CRITICAL"
        effortHours: 4
        agent:
          type: "backend-engineer"
          specialization: "State machines, fault tolerance, monitoring"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T5: Circuit Breaker Service"
        outputs:
          - path: "conductor-api/src/services/circuit-breaker.ts"
            type: "typescript"
          - path: "conductor-api/src/tests/circuit-breaker.test.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/services/circuit-breaker.ts"]
          - type: "typescript_compile"
            files: ["conductor-api/src/services/circuit-breaker.ts"]
          - type: "unit_tests"
            testFile: "conductor-api/src/tests/circuit-breaker.test.ts"
            minTests: 10
        dependencies: ["T1", "T2"]

      - taskId: "T6"
        title: "Dead Letter Queue Service"
        priority: "HIGH"
        effortHours: 3
        agent:
          type: "backend-engineer"
          specialization: "Queue systems, message handling"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T6: Dead Letter Queue Service"
        outputs:
          - path: "conductor-api/src/services/dead-letter-queue.ts"
            type: "typescript"
          - path: "conductor-api/src/workers/dlq-processor.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/services/dead-letter-queue.ts"]
          - type: "typescript_compile"
            files: ["conductor-api/src/services/dead-letter-queue.ts"]
        dependencies: ["T1", "T2"]

      - taskId: "T7"
        title: "Scheduler Core Engine"
        priority: "CRITICAL"
        effortHours: 4
        agent:
          type: "backend-engineer"
          specialization: "Cron scheduling, task execution, event loops"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T7: Scheduler Core Engine"
        outputs:
          - path: "conductor-api/src/services/scheduler-core.ts"
            type: "typescript"
          - path: "conductor-api/src/workers/schedule-executor.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/services/scheduler-core.ts"]
          - type: "typescript_compile"
            files: ["conductor-api/src/services/scheduler-core.ts"]
        dependencies: ["T1"]

      - taskId: "T8"
        title: "API Versioning Middleware"
        priority: "HIGH"
        effortHours: 2
        agent:
          type: "backend-engineer"
          specialization: "Middleware, request routing, versioning"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T8: API Versioning Middleware"
        outputs:
          - path: "conductor-api/src/middleware/api-version.ts"
            type: "typescript"
          - path: "conductor-api/src/middleware/v2-error-handler.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/middleware/api-version.ts"]
          - type: "typescript_compile"
            files: ["conductor-api/src/middleware/"]
        dependencies: ["T3"]

  - groupId: "GROUP_C"
    name: "API Endpoints Layer"
    parallelism: 5
    day: 3
    dependsOnGroup: "GROUP_B"
    tasks:
      - taskId: "T9"
        title: "Error Recovery Endpoints"
        priority: "CRITICAL"
        effortHours: 4
        agent:
          type: "backend-engineer"
          specialization: "REST APIs, request validation, response formatting"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T9: Error Recovery Endpoints"
        outputs:
          - path: "conductor-api/src/routes/v2/error-recovery.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/routes/v2/error-recovery.ts"]
          - type: "typescript_compile"
            files: ["conductor-api/src/routes/v2/error-recovery.ts"]
          - type: "api_endpoints"
            endpoints: ["POST /v2/errors/retry", "GET /v2/errors/retry/:id", "POST /v2/errors/resolve"]
        dependencies: ["T4", "T5", "T6", "T8"]

      - taskId: "T10"
        title: "Scheduler Endpoints"
        priority: "CRITICAL"
        effortHours: 4
        agent:
          type: "backend-engineer"
          specialization: "REST APIs, cron management"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T10: Scheduler Endpoints"
        outputs:
          - path: "conductor-api/src/routes/v2/scheduling.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/routes/v2/scheduling.ts"]
          - type: "api_endpoints"
            endpoints: ["POST /v2/schedules", "GET /v2/schedules/:id", "PUT /v2/schedules/:id"]
        dependencies: ["T7", "T8"]

      - taskId: "T11"
        title: "Webhook Service"
        priority: "HIGH"
        effortHours: 3
        agent:
          type: "backend-engineer"
          specialization: "Event handling, HTTP callbacks"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T11: Webhook Service"
        outputs:
          - path: "conductor-api/src/services/webhook-service.ts"
            type: "typescript"
          - path: "conductor-api/src/routes/v2/webhooks.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/services/webhook-service.ts"]
        dependencies: ["T8"]

      - taskId: "T12"
        title: "Batch Operations API"
        priority: "HIGH"
        effortHours: 3
        agent:
          type: "backend-engineer"
          specialization: "Bulk operations, transaction handling"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T12: Batch Operations API"
        outputs:
          - path: "conductor-api/src/routes/v2/batch.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/routes/v2/batch.ts"]
        dependencies: ["T8", "T9", "T10"]

  - groupId: "GROUP_D"
    name: "Integration & Real-time Layer"
    parallelism: 5
    day: 4
    dependsOnGroup: "GROUP_C"
    tasks:
      - taskId: "T13"
        title: "WebSocket Event Streaming"
        priority: "HIGH"
        effortHours: 4
        agent:
          type: "backend-engineer"
          specialization: "WebSockets, real-time events, broadcasting"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T13: WebSocket Event Streaming"
        outputs:
          - path: "conductor-api/src/websocket/event-streamer.ts"
            type: "typescript"
          - path: "conductor-api/src/websocket/handlers.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/websocket/event-streamer.ts"]
        dependencies: ["T9", "T10"]

      - taskId: "T14"
        title: "Metrics Collection Service"
        priority: "HIGH"
        effortHours: 4
        agent:
          type: "backend-engineer"
          specialization: "Metrics, observability, time-series data"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T14: Metrics Collection Service"
        outputs:
          - path: "conductor-api/src/services/metrics-collector.ts"
            type: "typescript"
          - path: "conductor-api/src/routes/v2/metrics.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/services/metrics-collector.ts"]
        dependencies: ["T9", "T10"]

      - taskId: "T15"
        title: "Dashboard Backend API"
        priority: "HIGH"
        effortHours: 4
        agent:
          type: "backend-engineer"
          specialization: "Data aggregation, API design"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T15: Dashboard Backend API"
        outputs:
          - path: "conductor-api/src/routes/v2/dashboard.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/routes/v2/dashboard.ts"]
        dependencies: ["T13", "T14"]

      - taskId: "T17"
        title: "Gantt Chart Component"
        priority: "HIGH"
        effortHours: 4
        agent:
          type: "frontend-engineer"
          specialization: "React, data visualization, D3/chart libraries"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T17: Gantt Chart Component"
        outputs:
          - path: "webapp/src/components/GanttChart.tsx"
            type: "typescript-react"
          - path: "webapp/src/hooks/useGanttData.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["webapp/src/components/GanttChart.tsx"]
        dependencies: ["T15", "T16"]

      - taskId: "T18"
        title: "Analytics Dashboard"
        priority: "HIGH"
        effortHours: 4
        agent:
          type: "frontend-engineer"
          specialization: "React, charting, data visualization"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T18: Analytics Dashboard"
        outputs:
          - path: "webapp/src/components/AnalyticsDashboard.tsx"
            type: "typescript-react"
          - path: "webapp/src/hooks/useAnalytics.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["webapp/src/components/AnalyticsDashboard.tsx"]
        dependencies: ["T15", "T16"]

      - taskId: "T19"
        title: "Real-time Update Integration"
        priority: "HIGH"
        effortHours: 4
        agent:
          type: "frontend-engineer"
          specialization: "WebSocket integration, real-time state management"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T19: Real-time Update Integration"
        outputs:
          - path: "webapp/src/hooks/useWebSocket.ts"
            type: "typescript"
          - path: "webapp/src/services/real-time-sync.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["webapp/src/hooks/useWebSocket.ts"]
        dependencies: ["T13", "T17", "T18"]

  - groupId: "GROUP_E"
    name: "Finalization & Testing Layer"
    parallelism: 3
    day: 5
    dependsOnGroup: "GROUP_D"
    tasks:
      - taskId: "T20"
        title: "Rate Limiting Middleware"
        priority: "HIGH"
        effortHours: 2
        agent:
          type: "backend-engineer"
          specialization: "Rate limiting, middleware, request throttling"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T20: Rate Limiting Middleware"
        outputs:
          - path: "conductor-api/src/middleware/rate-limiter.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["conductor-api/src/middleware/rate-limiter.ts"]
        dependencies: ["T9", "T10", "T11", "T12"]

      - taskId: "T21"
        title: "Integration Testing Suite"
        priority: "CRITICAL"
        effortHours: 6
        agent:
          type: "qa-engineer"
          specialization: "Integration testing, test automation, E2E tests"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T21: Integration Testing Suite"
        outputs:
          - path: "conductor-api/src/__tests__/integration/"
            type: "typescript"
          - path: "ops/tests/phase5.3-integration.ts"
            type: "typescript"
        validation:
          - type: "file_exists"
            paths: ["ops/tests/phase5.3-integration.ts"]
          - type: "test_execution"
            minTests: 30
            minCoverage: 80
        dependencies: ["T4", "T5", "T6", "T7", "T8", "T9", "T10", "T11", "T12", "T13", "T14", "T15", "T17", "T18", "T19"]

      - taskId: "T22"
        title: "Performance Validation"
        priority: "CRITICAL"
        effortHours: 4
        agent:
          type: "performance-engineer"
          specialization: "Performance testing, load testing, benchmarks"
        inputs:
          - path: "docs/04-planning/K1NPlan_PHASE5_3_ATOMIC_TASK_BREAKDOWN_v1.0_20251110.md"
            section: "T22: Performance Validation"
        outputs:
          - path: "ops/tests/phase5.3-performance.ts"
            type: "typescript"
          - path: "docs/09-reports/K1NReport_PHASE5_3_PERFORMANCE_VALIDATION_20251110.md"
            type: "markdown"
        validation:
          - type: "file_exists"
            paths: ["ops/tests/phase5.3-performance.ts"]
          - type: "performance_benchmarks"
            metrics: ["response_time_p99", "throughput", "error_rate"]
        dependencies: ["T21"]

---
# Execution Configuration
execution:
  startDate: "2025-11-10"
  checkpointInterval: "8 hours"
  checkpointAction: "review-and-commit"

  workspaceIsolation:
    enabled: true
    perAgentWorkspace: true
    baseDir: ".conductor/workspaces"
    gitWorktreePrefix: "agent-"

  agentSpawning:
    method: "conductor-agent-spawn"
    timeout: "6 hours per task"
    maxRetries: 2
    fallback: "human-review"

  monitoring:
    enabled: true
    logFile: "docs/09-reports/PHASE5_3_EXECUTION_LOG_20251110.md"
    updateInterval: "30 minutes"
    metrics:
      - "tasks_completed"
      - "tasks_in_progress"
      - "tasks_blocked"
      - "average_completion_time"

  validation:
    preTaskValidation: true
    postTaskValidation: true
    gateBeforeNextPhase: true
    failureAction: "review-and-replan"

---
# Success Criteria
successCriteria:
  overall:
    - "All 22 tasks completed"
    - "Zero compilation errors"
    - "All validation checks pass"
    - "Integration tests ≥30, coverage ≥80%"
    - "Performance benchmarks met"

  perGroup:
    GROUP_A:
      - "Schema file exists and is syntactically valid"
      - "4 service interfaces compile without errors"
      - "API routes scaffold complete"
      - "Dashboard scaffolding complete"
    GROUP_B:
      - "All 5 services implement core logic"
      - "Unit tests for each service pass"
      - "No circular dependencies"
    GROUP_C:
      - "All API endpoints respond correctly"
      - "Request validation works"
      - "Error handling implemented"
    GROUP_D:
      - "WebSocket events broadcast correctly"
      - "Metrics collected and queryable"
      - "Dashboard API returns aggregated data"
      - "UI components render without errors"
    GROUP_E:
      - "Rate limiting enforced"
      - "Integration tests pass"
      - "Performance targets met"

---
# Rollback Plan
rollback:
  strategy: "git-branch-revert"
  method: |
    For each failed task:
    1. Revert the agent's commits (git revert COMMIT_HASH)
    2. Update status in PHASE5_3_EXECUTION_LOG_20251110.md
    3. Re-review task spec and replan
    4. Respawn agent with updated instruction

  checkpoints:
    GROUP_A: "2025-11-10 20:00"
    GROUP_B: "2025-11-11 16:00"
    GROUP_C: "2025-11-12 16:00"
    GROUP_D: "2025-11-13 16:00"
    GROUP_E: "2025-11-14 20:00"
